[2025-09-13 11:04:37] ============================================================
[2025-09-13 11:04:37] 【训练数据信息】
[2025-09-13 11:04:37] 原始X类型: <class 'list'>, 长度: 1
[2025-09-13 11:04:37] 原始y类型: <class 'list'>, 长度: 42
[2025-09-13 11:04:37] ============================================================
[2025-09-13 11:04:37] 
===== 转换样本为NumPy数组 =====
[2025-09-13 11:04:37] 样本0：已从list转换为数组，形状=(288, 1800, 1)
[2025-09-13 11:04:37] 样本1：已从list转换为数组，形状=(227, 1800, 1)
[2025-09-13 11:04:37] 样本2：已从list转换为数组，形状=(381, 1800, 1)
[2025-09-13 11:04:37] 样本3：已从list转换为数组，形状=(428, 1800, 1)
[2025-09-13 11:04:37] 样本4：已从list转换为数组，形状=(406, 1800, 1)
[2025-09-13 11:04:37] 样本5：已从list转换为数组，形状=(125, 1800, 1)
[2025-09-13 11:04:37] 样本6：已从list转换为数组，形状=(324, 1800, 1)
[2025-09-13 11:04:37] 样本7：已从list转换为数组，形状=(202, 1800, 1)
[2025-09-13 11:04:37] 样本8：已从list转换为数组，形状=(137, 1800, 1)
[2025-09-13 11:04:37] 样本9：已从list转换为数组，形状=(276, 1800, 1)
[2025-09-13 11:04:37] 样本10：已从list转换为数组，形状=(417, 1800, 1)
[2025-09-13 11:04:38] 样本11：已从list转换为数组，形状=(455, 1800, 1)
[2025-09-13 11:04:38] 样本12：已从list转换为数组，形状=(178, 1800, 1)
[2025-09-13 11:04:38] 样本13：已从list转换为数组，形状=(446, 1800, 1)
[2025-09-13 11:04:38] 样本14：已从list转换为数组，形状=(280, 1800, 1)
[2025-09-13 11:04:38] 样本15：已从list转换为数组，形状=(835, 1800, 1)
[2025-09-13 11:04:38] 样本16：已从list转换为数组，形状=(144, 1800, 1)
[2025-09-13 11:04:38] 样本17：已从list转换为数组，形状=(238, 1800, 1)
[2025-09-13 11:04:38] 样本18：已从list转换为数组，形状=(335, 1800, 1)
[2025-09-13 11:04:38] 样本19：已从list转换为数组，形状=(475, 1800, 1)
[2025-09-13 11:04:38] 样本20：已从list转换为数组，形状=(351, 1800, 1)
[2025-09-13 11:04:38] 样本21：已从list转换为数组，形状=(382, 1800, 1)
[2025-09-13 11:04:38] 样本22：已从list转换为数组，形状=(635, 1800, 1)
[2025-09-13 11:04:38] 样本23：已从list转换为数组，形状=(337, 1800, 1)
[2025-09-13 11:04:38] 样本24：已从list转换为数组，形状=(537, 1800, 1)
[2025-09-13 11:04:38] 样本25：已从list转换为数组，形状=(347, 1800, 1)
[2025-09-13 11:04:38] 样本26：已从list转换为数组，形状=(362, 1800, 1)
[2025-09-13 11:04:38] 样本27：已从list转换为数组，形状=(355, 1800, 1)
[2025-09-13 11:04:38] 样本28：已从list转换为数组，形状=(192, 1800, 1)
[2025-09-13 11:04:38] 样本29：已从list转换为数组，形状=(462, 1800, 1)
[2025-09-13 11:04:38] 样本30：已从list转换为数组，形状=(784, 1800, 1)
[2025-09-13 11:04:38] 样本31：已从list转换为数组，形状=(479, 1800, 1)
[2025-09-13 11:04:38] 样本32：已从list转换为数组，形状=(271, 1800, 1)
[2025-09-13 11:04:38] 样本33：已从list转换为数组，形状=(446, 1800, 1)
[2025-09-13 11:04:38] 样本34：已从list转换为数组，形状=(539, 1800, 1)
[2025-09-13 11:04:38] 样本35：已从list转换为数组，形状=(443, 1800, 1)
[2025-09-13 11:04:38] 样本36：已从list转换为数组，形状=(201, 1800, 1)
[2025-09-13 11:04:38] 样本37：已从list转换为数组，形状=(294, 1800, 1)
[2025-09-13 11:04:38] 样本38：已从list转换为数组，形状=(403, 1800, 1)
[2025-09-13 11:04:38] 样本39：已从list转换为数组，形状=(697, 1800, 1)
[2025-09-13 11:04:38] 样本40：已从list转换为数组，形状=(810, 1800, 1)
[2025-09-13 11:04:38] 样本41：已从list转换为数组，形状=(714, 1800, 1)
[2025-09-13 11:04:38] ===========================

[2025-09-13 11:04:38] 当前批次最长序列长度（窗口数）: 835
[2025-09-13 11:04:38] X填充后形状: (42, 835, 1800, 1)
[2025-09-13 11:04:38] 掩码形状: (42, 835)
[2025-09-13 11:04:38] 
===== 处理标签（过滤填充窗口） =====
[2025-09-13 11:04:38] 有效类别（排除填充）: [0, 1, 2, 3]
[2025-09-13 11:04:38] y填充后形状: (42, 835)
[2025-09-13 11:04:38] X填充值替换为均值: -0.0002
[2025-09-13 11:04:39] 标准化后X统计: min=-18.8607, max=18.9168
[2025-09-13 11:04:42] 已检测到 3 个GPU，将用于分布式训练
[2025-09-13 11:04:43] 
模型初始化完成（多GPU支持），结构如下：
[2025-09-13 11:04:43] Model: "sequential"
[2025-09-13 11:04:43] _________________________________________________________________
[2025-09-13 11:04:43]  Layer (type)                Output Shape              Param #   
[2025-09-13 11:04:43] =================================================================
[2025-09-13 11:04:43]  time_distributed_cnn (TimeD  (None, 835, 3200)        57152     
[2025-09-13 11:04:43]  istributed)                                                     
[2025-09-13 11:04:43]                                                                  
[2025-09-13 11:04:43]  bidirectional_gru (Bidirect  (None, 835, 256)         2557440   
[2025-09-13 11:04:43]  ional)                                                          
[2025-09-13 11:04:43]                                                                  
[2025-09-13 11:04:43]  time_distributed_ffn (TimeD  (None, 835, 4)           100740    
[2025-09-13 11:04:43]  istributed)                                                     
[2025-09-13 11:04:43]                                                                  
[2025-09-13 11:04:43] =================================================================
[2025-09-13 11:04:43] Total params: 2,715,332
[2025-09-13 11:04:43] Trainable params: 2,714,052
[2025-09-13 11:04:43] Non-trainable params: 1,280
[2025-09-13 11:04:43] _________________________________________________________________
[2025-09-13 11:04:43] 监控批次形状 - X: (5, 835, 1800, 1), y: (5, 835)
[2025-09-13 11:04:43] 使用验证集: True, 验证比例: 0.2
[2025-09-13 11:04:43] 
===== 类别权重 =====
[2025-09-13 11:04:43] 类别 0: 样本数=1767, 权重=1.5341
[2025-09-13 11:04:43] 类别 1: 样本数=6427, 权重=0.6931
[2025-09-13 11:04:43] 类别 2: 样本数=3480, 权重=1.0462
[2025-09-13 11:04:43] 类别 3: 样本数=4964, 权重=0.8306
[2025-09-13 11:04:43] ====================

[2025-09-13 11:04:43] 训练过程出错: shape mismatch: value array of shape (835,) could not be broadcast to indexing result of shape (16,)