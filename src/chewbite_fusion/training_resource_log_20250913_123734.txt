[2025-09-13 12:37:34] ============================================================
[2025-09-13 12:37:34] 【训练数据信息】
[2025-09-13 12:37:34] 原始X类型: <class 'list'>, 长度: 1
[2025-09-13 12:37:34] 原始y类型: <class 'list'>, 长度: 42
[2025-09-13 12:37:34] ============================================================
[2025-09-13 12:37:34] 
===== 转换样本为NumPy数组 =====
[2025-09-13 12:37:34] 样本0：已从list转换为数组，形状=(381, 1800, 1)
[2025-09-13 12:37:34] 样本1：已从list转换为数组，形状=(428, 1800, 1)
[2025-09-13 12:37:34] 样本2：已从list转换为数组，形状=(426, 1800, 1)
[2025-09-13 12:37:34] 样本3：已从list转换为数组，形状=(406, 1800, 1)
[2025-09-13 12:37:34] 样本4：已从list转换为数组，形状=(516, 1800, 1)
[2025-09-13 12:37:34] 样本5：已从list转换为数组，形状=(324, 1800, 1)
[2025-09-13 12:37:34] 样本6：已从list转换为数组，形状=(202, 1800, 1)
[2025-09-13 12:37:34] 样本7：已从list转换为数组，形状=(137, 1800, 1)
[2025-09-13 12:37:34] 样本8：已从list转换为数组，形状=(276, 1800, 1)
[2025-09-13 12:37:34] 样本9：已从list转换为数组，形状=(417, 1800, 1)
[2025-09-13 12:37:34] 样本10：已从list转换为数组，形状=(455, 1800, 1)
[2025-09-13 12:37:34] 样本11：已从list转换为数组，形状=(178, 1800, 1)
[2025-09-13 12:37:34] 样本12：已从list转换为数组，形状=(446, 1800, 1)
[2025-09-13 12:37:34] 样本13：已从list转换为数组，形状=(518, 1800, 1)
[2025-09-13 12:37:34] 样本14：已从list转换为数组，形状=(280, 1800, 1)
[2025-09-13 12:37:34] 样本15：已从list转换为数组，形状=(835, 1800, 1)
[2025-09-13 12:37:34] 样本16：已从list转换为数组，形状=(144, 1800, 1)
[2025-09-13 12:37:35] 样本17：已从list转换为数组，形状=(1013, 1800, 1)
[2025-09-13 12:37:35] 样本18：已从list转换为数组，形状=(335, 1800, 1)
[2025-09-13 12:37:35] 样本19：已从list转换为数组，形状=(714, 1800, 1)
[2025-09-13 12:37:35] 样本20：已从list转换为数组，形状=(475, 1800, 1)
[2025-09-13 12:37:35] 样本21：已从list转换为数组，形状=(301, 1800, 1)
[2025-09-13 12:37:35] 样本22：已从list转换为数组，形状=(351, 1800, 1)
[2025-09-13 12:37:35] 样本23：已从list转换为数组，形状=(382, 1800, 1)
[2025-09-13 12:37:35] 样本24：已从list转换为数组，形状=(537, 1800, 1)
[2025-09-13 12:37:35] 样本25：已从list转换为数组，形状=(362, 1800, 1)
[2025-09-13 12:37:35] 样本26：已从list转换为数组，形状=(192, 1800, 1)
[2025-09-13 12:37:35] 样本27：已从list转换为数组，形状=(462, 1800, 1)
[2025-09-13 12:37:35] 样本28：已从list转换为数组，形状=(386, 1800, 1)
[2025-09-13 12:37:35] 样本29：已从list转换为数组，形状=(784, 1800, 1)
[2025-09-13 12:37:35] 样本30：已从list转换为数组，形状=(390, 1800, 1)
[2025-09-13 12:37:35] 样本31：已从list转换为数组，形状=(551, 1800, 1)
[2025-09-13 12:37:35] 样本32：已从list转换为数组，形状=(271, 1800, 1)
[2025-09-13 12:37:35] 样本33：已从list转换为数组，形状=(446, 1800, 1)
[2025-09-13 12:37:35] 样本34：已从list转换为数组，形状=(539, 1800, 1)
[2025-09-13 12:37:35] 样本35：已从list转换为数组，形状=(201, 1800, 1)
[2025-09-13 12:37:35] 样本36：已从list转换为数组，形状=(294, 1800, 1)
[2025-09-13 12:37:35] 样本37：已从list转换为数组，形状=(230, 1800, 1)
[2025-09-13 12:37:35] 样本38：已从list转换为数组，形状=(403, 1800, 1)
[2025-09-13 12:37:35] 样本39：已从list转换为数组，形状=(697, 1800, 1)
[2025-09-13 12:37:35] 样本40：已从list转换为数组，形状=(810, 1800, 1)
[2025-09-13 12:37:35] 样本41：已从list转换为数组，形状=(714, 1800, 1)
[2025-09-13 12:37:35] ===========================

[2025-09-13 12:37:35] 当前批次最长序列长度（窗口数）: 1013
[2025-09-13 12:37:35] X填充后形状: (42, 1013, 1800, 1)
[2025-09-13 12:37:35] 检测到的类别: [0, 1, 2, 3], 填充类别编号: 4
[2025-09-13 12:37:35] y填充后形状: (42, 1013)
[2025-09-13 12:37:36] X填充值替换为均值: -0.0002
[2025-09-13 12:37:36] 标准化后X统计: min=-19.5219, max=19.5816
[2025-09-13 12:37:36] 已检测到 3 个GPU，将用于分布式训练
[2025-09-13 12:37:38] 
模型初始化完成（多GPU支持），结构如下：
[2025-09-13 12:37:38] Model: "sequential_3"
[2025-09-13 12:37:38] _________________________________________________________________
[2025-09-13 12:37:38]  Layer (type)                Output Shape              Param #   
[2025-09-13 12:37:38] =================================================================
[2025-09-13 12:37:38]  time_distributed_cnn (TimeD  (None, 1013, 3200)       57152     
[2025-09-13 12:37:38]  istributed)                                                     
[2025-09-13 12:37:38]                                                                  
[2025-09-13 12:37:38]  bidirectional_gru (Bidirect  (None, 1013, 256)        2557440   
[2025-09-13 12:37:38]  ional)                                                          
[2025-09-13 12:37:38]                                                                  
[2025-09-13 12:37:38]  time_distributed_ffn (TimeD  (None, 1013, 4)          100740    
[2025-09-13 12:37:38]  istributed)                                                     
[2025-09-13 12:37:38]                                                                  
[2025-09-13 12:37:38] =================================================================
[2025-09-13 12:37:38] Total params: 2,715,332
[2025-09-13 12:37:38] Trainable params: 2,714,052
[2025-09-13 12:37:38] Non-trainable params: 1,280
[2025-09-13 12:37:38] _________________________________________________________________
[2025-09-13 12:37:38] 监控批次形状 - X: (5, 1013, 1800, 1), y: (5, 1013)
[2025-09-13 12:37:38] 使用验证集: True, 验证比例: 0.2
[2025-09-13 12:37:38] 
===== 类别权重 =====
[2025-09-13 12:37:38] 类别 0 (普通类别): 样本数=2010, 权重=2.5732
[2025-09-13 12:37:38] 类别 1 (普通类别): 样本数=6547, 权重=1.5512
[2025-09-13 12:37:38] 类别 2 (普通类别): 样本数=3457, 权重=2.0844
[2025-09-13 12:37:38] 类别 3 (普通类别): 样本数=6195, 权重=1.5950
[2025-09-13 12:37:38] 类别 4 (填充类别): 样本数=24337, 权重=0.0000
[2025-09-13 12:37:38] ====================

[2025-09-13 12:37:38] 样本权重范围: [0.0000, 2.5732]
[2025-09-13 12:37:38] 
【开始训练】样本数: 42, 批次大小: 5, GPU数量: 3
[2025-09-13 12:37:39] 
===== 系统资源监控初始化 =====
[2025-09-13 12:37:39] ===== 系统基本信息 =====
[2025-09-13 12:37:39] CPU核心数: 48 (物理核心: 24)
[2025-09-13 12:37:39] 总内存: 251.56 GB
[2025-09-13 12:37:39] 初始可用内存: 191.28 GB
[2025-09-13 12:37:39] GPU 0: NVIDIA GeForce RTX 3090
[2025-09-13 12:37:39]   总显存: 24.00 GB
[2025-09-13 12:37:39]   初始可用显存: 0.79 GB
[2025-09-13 12:37:39] GPU 1: NVIDIA GeForce RTX 3090
[2025-09-13 12:37:39]   总显存: 24.00 GB
[2025-09-13 12:37:39]   初始可用显存: 4.82 GB
[2025-09-13 12:37:39] GPU 2: NVIDIA GeForce RTX 3090
[2025-09-13 12:37:39]   总显存: 24.00 GB
[2025-09-13 12:37:39]   初始可用显存: 4.82 GB
[2025-09-13 12:37:39] ========================

[2025-09-13 12:39:28] 
===== Epoch 0 层 time_distributed_cnn 输出监控 =====
[2025-09-13 12:39:28] 形状: (5, 1013, 3200)
[2025-09-13 12:39:28] 最小值: -340282346638528859811704183484516925440.000000, 最大值: -340282346638528859811704183484516925440.000000
[2025-09-13 12:39:28] 含Inf: False
[2025-09-13 12:39:28] =========================================

[2025-09-13 12:39:28] 
===== Epoch 0 层 bidirectional_gru 输出监控 =====
[2025-09-13 12:39:28] 形状: (5, 1013, 256)
[2025-09-13 12:39:28] 层输出监控出错: 检测到NaN值！
出现位置:  numpy数组中存在NaN，形状: (5, 1013, 256)
处理过程链: Epoch 0 监控批次输入 -> Epoch 0 层 time_distributed_cnn 输出 -> Epoch 0 层 bidirectional_gru 输出
[2025-09-13 12:39:44] Epoch 0 梯度包含NaN!
[2025-09-13 12:39:44] Epoch 0 梯度范数最大值: nan
[2025-09-13 12:39:44] 
===== Epoch 0 资源使用统计 =====
[2025-09-13 12:39:44] CPU使用率: 0.2%
[2025-09-13 12:39:44] 内存状态: 已用 57.50 GB / 总 251.56 GB / 可用 190.90 GB (75.9%)
[2025-09-13 12:39:44] GPU 0 状态: 使用率 4%, 显存(已用/总/可用): 23.21 / 24.00 / 0.79 GB, 温度 46°C
[2025-09-13 12:39:44] GPU 1 状态: 使用率 5%, 显存(已用/总/可用): 19.18 / 24.00 / 4.82 GB, 温度 50°C
[2025-09-13 12:39:44] GPU 2 状态: 使用率 29%, 显存(已用/总/可用): 19.18 / 24.00 / 4.82 GB, 温度 42°C
[2025-09-13 12:39:44] 当前进程内存使用: 12.19 GB
[2025-09-13 12:39:44] =================================

[2025-09-13 12:40:45] 
===== Epoch 1 层 time_distributed_cnn 输出监控 =====
[2025-09-13 12:40:45] 形状: (5, 1013, 3200)
[2025-09-13 12:40:45] 最小值: -340282346638528859811704183484516925440.000000, 最大值: -340282346638528859811704183484516925440.000000
[2025-09-13 12:40:45] 含Inf: False
[2025-09-13 12:40:45] =========================================

[2025-09-13 12:40:45] 
===== Epoch 1 层 bidirectional_gru 输出监控 =====
[2025-09-13 12:40:45] 形状: (5, 1013, 256)
[2025-09-13 12:40:45] 层输出监控出错: 检测到NaN值！
出现位置:  numpy数组中存在NaN，形状: (5, 1013, 256)
处理过程链: Epoch 0 监控批次输入 -> Epoch 0 层 time_distributed_cnn 输出 -> Epoch 0 层 bidirectional_gru 输出 -> Epoch 1 监控批次输入 -> Epoch 1 层 time_distributed_cnn 输出 -> Epoch 1 层 bidirectional_gru 输出
[2025-09-13 12:40:49] Epoch 1 梯度包含NaN!
[2025-09-13 12:40:49] Epoch 1 梯度范数最大值: nan
[2025-09-13 12:40:49] 
===== Epoch 1 资源使用统计 =====
[2025-09-13 12:40:49] CPU使用率: 0.0%
[2025-09-13 12:40:49] 内存状态: 已用 57.57 GB / 总 251.56 GB / 可用 190.83 GB (75.9%)
[2025-09-13 12:40:49] GPU 0 状态: 使用率 35%, 显存(已用/总/可用): 23.21 / 24.00 / 0.79 GB, 温度 47°C
[2025-09-13 12:40:49] GPU 1 状态: 使用率 1%, 显存(已用/总/可用): 19.18 / 24.00 / 4.82 GB, 温度 51°C
[2025-09-13 12:40:49] GPU 2 状态: 使用率 1%, 显存(已用/总/可用): 19.18 / 24.00 / 4.82 GB, 温度 42°C
[2025-09-13 12:40:49] 当前进程内存使用: 12.24 GB
[2025-09-13 12:40:49] =================================

[2025-09-13 12:40:49] 
训练总耗时: 0小时3分钟10.97秒
[2025-09-13 12:40:49] 
===== 内存使用总结 =====
[2025-09-13 12:40:49] CPU内存状态:
[2025-09-13 12:40:49]   总内存: 251.56 GB
[2025-09-13 12:40:49]   已使用: 57.57 GB (24.1%)
[2025-09-13 12:40:49]   剩余可用: 190.83 GB
[2025-09-13 12:40:49]   使用峰值: 57.57 GB
[2025-09-13 12:40:49] 进程内存使用峰值: 12.24 GB
[2025-09-13 12:40:49] GPU 0 (NVIDIA GeForce RTX 3090) 显存状态:
[2025-09-13 12:40:49]   总显存: 24.00 GB
[2025-09-13 12:40:49]   已使用: 23.21 GB (96.7%)
[2025-09-13 12:40:49]   剩余可用: 0.79 GB
[2025-09-13 12:40:49]   使用峰值: 23.21 GB
[2025-09-13 12:40:49] GPU 1 (NVIDIA GeForce RTX 3090) 显存状态:
[2025-09-13 12:40:49]   总显存: 24.00 GB
[2025-09-13 12:40:49]   已使用: 19.18 GB (79.9%)
[2025-09-13 12:40:49]   剩余可用: 4.82 GB
[2025-09-13 12:40:49]   使用峰值: 19.18 GB
[2025-09-13 12:40:49] GPU 2 (NVIDIA GeForce RTX 3090) 显存状态:
[2025-09-13 12:40:49]   总显存: 24.00 GB
[2025-09-13 12:40:49]   已使用: 19.18 GB (79.9%)
[2025-09-13 12:40:49]   剩余可用: 4.82 GB
[2025-09-13 12:40:49]   使用峰值: 19.18 GB
[2025-09-13 12:40:49] =======================

[2025-09-13 12:40:49] 
===== 训练总结 =====
[2025-09-13 12:40:49] 总训练轮次: 2
[2025-09-13 12:40:49] 实际训练轮次: 2
[2025-09-13 12:40:49] 最终训练损失: nan
[2025-09-13 12:40:49] 最终训练准确率: 0.1761
[2025-09-13 12:40:49] 总训练时间: 195.03秒
[2025-09-13 12:40:49] 最终验证损失: nan
[2025-09-13 12:40:49] 最终验证准确率: 0.1056
[2025-09-13 12:40:49] 最佳验证损失: nan (在第1轮)
[2025-09-13 12:40:49] 最佳验证准确率: 0.1056 (在第1轮)
[2025-09-13 12:40:49] ====================
